-- Mini UI Hub (FIXED - Functional)
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Player = Players.LocalPlayer

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MiniUIHub"
screenGui.ResetOnSpawn = false
screenGui.Parent = Player:WaitForChild("PlayerGui")

-- HSV â†’ RGB
local function HSV(h,s,v)
	return Color3.fromHSV(h%1,s,v)
end

-- CREATE WINDOW
function createMiniWindow(title, posX, contentHeight)
	contentHeight = contentHeight or 120

	local frame = Instance.new("Frame")
	frame.Size = UDim2.new(0,200,0,40)
	frame.Position = UDim2.new(0,posX,0,60)
	frame.BackgroundColor3 = Color3.fromRGB(0,0,0)
	frame.BorderSizePixel = 0
	frame.ClipsDescendants = true
	frame.Parent = screenGui

	Instance.new("UICorner",frame).CornerRadius = UDim.new(0,10)

	-- HEADER
	local header = Instance.new("Frame",frame)
	header.Size = UDim2.new(1,0,0,40)
	header.BackgroundTransparency = 1

	local line = Instance.new("Frame",header)
	line.Size = UDim2.new(1,-20,0,2)
	line.Position = UDim2.new(0,10,0.15,0)
	line.BorderSizePixel = 0

	local titleLabel = Instance.new("TextLabel",header)
	titleLabel.Size = UDim2.new(1,-40,0,18)
	titleLabel.Position = UDim2.new(0,10,0.35,0)
	titleLabel.Text = title
	titleLabel.BackgroundTransparency = 1
	titleLabel.TextColor3 = Color3.new(1,1,1)
	titleLabel.Font = Enum.Font.GothamSemibold
	titleLabel.TextSize = 14
	titleLabel.TextXAlignment = Left

	local toggleBtn = Instance.new("TextButton",header)
	toggleBtn.Size = UDim2.new(0,25,0,25)
	toggleBtn.Position = UDim2.new(1,-35,0.25,0)
	toggleBtn.Text = "-"
	toggleBtn.BackgroundTransparency = 1
	toggleBtn.TextColor3 = Color3.new(1,1,1)
	toggleBtn.Font = Enum.Font.GothamBold
	toggleBtn.TextScaled = true

	-- CONTENT
	local content = Instance.new("Frame",frame)
	content.Size = UDim2.new(1,0,0,contentHeight)
	content.Position = UDim2.new(0,0,0,40)
	content.BackgroundColor3 = Color3.fromRGB(30,30,30)

	local layout = Instance.new("UIListLayout",content)
	layout.Padding = UDim.new(0,6)

	-- MINIMIZE
	local open = true
	toggleBtn.MouseButton1Click:Connect(function()
		open = not open
		toggleBtn.Text = open and "-" or "+"
		content.Visible = open
		TweenService:Create(
			frame,
			TweenInfo.new(0.25,Enum.EasingStyle.Quad),
			{Size = UDim2.new(0,200,0,open and (40+contentHeight) or 40)}
		):Play()
	end)

	-- DRAG
	local dragging, dragStart, startPos
	frame.InputBegan:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			dragStart = i.Position
			startPos = frame.Position
			i.Changed:Connect(function()
				if i.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)

	UserInputService.InputChanged:Connect(function(i)
		if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
			local delta = i.Position - dragStart
			frame.Position = UDim2.new(
				startPos.X.Scale,
				startPos.X.Offset + delta.X,
				startPos.Y.Scale,
				startPos.Y.Offset + delta.Y
			)
		end
	end)

	-- RAINBOW LINE
	task.spawn(function()
		local h = 0
		while frame.Parent do
			h += 0.005
			line.BackgroundColor3 = HSV(h,1,1)
			RunService.RenderStepped:Wait()
		end
	end)

	-- WINDOW API
	local window = {}

	function window:AddLabel(text)
		local lbl = Instance.new("TextLabel",content)
		lbl.Size = UDim2.new(1,-10,0,22)
		lbl.BackgroundTransparency = 1
		lbl.Text = text
		lbl.TextColor3 = Color3.new(1,1,1)
		lbl.Font = Enum.Font.Gotham
		lbl.TextSize = 13
		lbl.TextXAlignment = Left
	end

	function window:AddToggle(text, callback)
		local btn = Instance.new("TextButton",content)
		btn.Size = UDim2.new(1,-10,0,26)
		btn.BackgroundTransparency = 1
		btn.Text = "[ OFF ]  "..text
		btn.TextColor3 = Color3.fromRGB(255,80,80)
		btn.Font = Enum.Font.GothamBold
		btn.TextSize = 13

		local state = false
		btn.MouseButton1Click:Connect(function()
			state = not state
			btn.Text = (state and "[ ON ]  " or "[ OFF ]  ")..text
			btn.TextColor3 = state and Color3.fromRGB(80,255,80) or Color3.fromRGB(255,80,80)
			pcall(callback,state)
		end)
	end

	function window:AddBox(text, callback)
		local box = Instance.new("TextBox",content)
		box.Size = UDim2.new(1,-10,0,26)
		box.PlaceholderText = text
		box.Text = ""
		box.BackgroundColor3 = Color3.fromRGB(20,20,20)
		box.TextColor3 = Color3.new(1,1,1)
		box.Font = Enum.Font.Gotham
		box.TextSize = 13
		Instance.new("UICorner",box).CornerRadius = UDim.new(0,6)

		box.FocusLost:Connect(function(enter)
			if enter then
				pcall(callback,box,true)
			end
		end)
	end

	return window
end    header.Size = UDim2.new(1,0,0,40)
    header.BackgroundTransparency = 1

    local line = Instance.new("Frame", header)
    line.Size = UDim2.new(1,-20,0,2)
    line.Position = UDim2.new(0,10,0.125,0)
    line.BackgroundColor3 = Color3.fromRGB(255,255,255)
    line.BorderSizePixel = 0

    local titleLabel = Instance.new("TextLabel", header)
    titleLabel.Size = UDim2.new(1,-40,0,18)
    titleLabel.Position = UDim2.new(0,10,0.25,0)
    titleLabel.Text = title
    titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Font = Enum.Font.GothamSemibold
    titleLabel.TextSize = 14
    titleLabel.TextXAlignment = Left

    local toggleBtn = Instance.new("TextButton", header)
    toggleBtn.Size = UDim2.new(0,25,0,25)
    toggleBtn.Position = UDim2.new(1,-35,0.25,0)
    toggleBtn.Text = "-"
    toggleBtn.BackgroundTransparency = 1
    toggleBtn.TextColor3 = Color3.fromRGB(255,255,255)
    toggleBtn.Font = Enum.Font.GothamBold
    toggleBtn.TextScaled = true

    -- CONTENT
    local content = Instance.new("Frame", frame)
    content.Position = UDim2.new(0,0,0,40)
    content.Size = UDim2.new(1,0,0,contentHeight)
    content.BackgroundColor3 = Color3.fromRGB(30,30,30)

    local layout = Instance.new("UIListLayout", content)
    layout.Padding = UDim.new(0,6)

    -- MINIMIZE
    local open = true
    toggleBtn.MouseButton1Click:Connect(function()
        open = not open
        toggleBtn.Text = open and "-" or "+"
        local h = open and (40 + contentHeight) or 40
        content.Visible = open
        TweenService:Create(frame,TweenInfo.new(0.3),{
            Size = UDim2.new(0,200,0,h)
        }):Play()
    end)

    -- DRAG
    frame.Active = true
    frame.Draggable = true

    -- RAINBOW LINE
    task.spawn(function()
        local hue = 0
        while frame.Parent do
            hue += 0.005
            line.BackgroundColor3 = HSV(hue,1,1)
            RunService.RenderStepped:Wait()
        end
    end)

    --==================================================
    -- API
    --==================================================

    local window = {}

    function window:AddText(text)
        local lbl = Instance.new("TextLabel", content)
        lbl.Size = UDim2.new(1,-20,0,20)
        lbl.BackgroundTransparency = 1
        lbl.Text = text
        lbl.TextColor3 = Color3.new(1,1,1)
        lbl.Font = Enum.Font.Gotham
        lbl.TextSize = 13
        lbl.TextXAlignment = Left
    end

    function window:AddToggle(text, callback)
        local btn = Instance.new("TextButton", content)
        btn.Size = UDim2.new(1,-20,0,25)
        btn.BackgroundTransparency = 1
        btn.Text = text .. " : OFF"
        btn.TextColor3 = Color3.fromRGB(255,0,0)
        btn.Font = Enum.Font.GothamBold
        btn.TextSize = 14

        local state = false
        btn.MouseButton1Click:Connect(function()
            state = not state
            btn.Text = text .. (state and " : ON" or " : OFF")
            btn.TextColor3 = state and Color3.fromRGB(0,255,0) or Color3.fromRGB(255,0,0)
            callback(state)
        end)
    end

    function window:AddBox(placeholder, callback)
        local box = Instance.new("TextBox", content)
        box.Size = UDim2.new(1,-20,0,25)
        box.PlaceholderText = placeholder
        box.BackgroundColor3 = Color3.fromRGB(40,40,40)
        box.TextColor3 = Color3.new(1,1,1)
        box.Font = Enum.Font.Gotham
        box.TextSize = 13

        box.FocusLost:Connect(function(enter)
            callback(box, enter)
        end)
    end

    return window
end
    -- CONTENT
    local content = Instance.new("Frame")
    content.Size = UDim2.new(1,0,0,contentHeight)
    content.Position = UDim2.new(0,0,0,40)
    content.BackgroundColor3 = Color3.fromRGB(30,30,30)
    content.Parent = frame

    -- FUNCION MAXIMIZAR/MINIMIZAR
    local contentVisible = true
    toggleBtn.MouseButton1Click:Connect(function()
        contentVisible = not contentVisible
        toggleBtn.Text = contentVisible and "-" or "+"
        local newHeight = contentVisible and (40 + contentHeight) or 40
        content.Visible = contentVisible
        TweenService:Create(frame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Size = UDim2.new(0,200,0,newHeight)}):Play()
    end)

    -- ARRASTRABLE
    local dragging = false
    local dragInput
    local startPos
    local startPosFrame

    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            startPos = input.Position
            startPosFrame = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - startPos
            frame.Position = UDim2.new(
                startPosFrame.X.Scale,
                startPosFrame.X.Offset + delta.X,
                startPosFrame.Y.Scale,
                startPosFrame.Y.Offset + delta.Y
            )
        end
    end)

    -- EFECTO ARCOIRIS PARA LINEA
    spawn(function()
        local hue = 0
        while true do
            hue = hue + 0.005
            line.BackgroundColor3 = HSV(hue,1,1)
            RunService.RenderStepped:Wait()
        end
    end)

    -- CONTENIDO INTERACTIVO
    local options = {"Auto", "Farm"}
    for i, name in ipairs(options) do
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(0.5, -10, 0, 25)
        label.Position = UDim2.new(0, 10, 0, 5 + (i-1)*30)
        label.BackgroundTransparency = 1
        label.Text = name
        label.TextColor3 = Color3.fromRGB(255,255,255)
        label.Font = Enum.Font.GothamSemibold
        label.TextSize = 14
        label.TextXAlignment = Enum.TextXAlignment.Left
        label.Parent = content

        local status = Instance.new("TextButton")
        status.Size = UDim2.new(0.3, 0, 0, 25)
        status.Position = UDim2.new(0.65, 0, 0, 5 + (i-1)*30)
        status.Text = "OFF"
        status.TextColor3 = Color3.fromRGB(255,0,0)
        status.Font = Enum.Font.GothamBold
        status.TextSize = 14
        status.BackgroundTransparency = 1 -- fondo transparente
        status.BorderSizePixel = 0
        status.Parent = content

        status.MouseButton1Click:Connect(function()
            if status.Text == "OFF" then
                status.Text = "ON"
                status.TextColor3 = Color3.fromRGB(0,255,0)
            else
                status.Text = "OFF"
                status.TextColor3 = Color3.fromRGB(255,0,0)
            end
        end)
    end

    return content
end

-- EJEMPLOS
local win1 = createMiniWindow("Auto Farm", 50, 80)
local win2 = createMiniWindow("Auto Delivery", 300, 100)
local win3 = createMiniWindow("Config", 550, 60)
